import{_ as s,c as a,o as e,aj as t}from"./chunks/framework.CSCBGoZg.js";const k=JSON.parse('{"title":"Error Rescue Operator (!>)","description":"","frontmatter":{},"headers":[],"relativePath":"specs/Error_rescue_operator.spec.md","filePath":"specs/Error_rescue_operator.spec.md"}'),n={name:"specs/Error_rescue_operator.spec.md"};function l(r,i,h,o,p,d){return e(),a("div",null,[...i[0]||(i[0]=[t(`<h1 id="error-rescue-operator" tabindex="-1">Error Rescue Operator (<code>!&gt;</code>) <a class="header-anchor" href="#error-rescue-operator" aria-label="Permalink to “Error Rescue Operator (!&gt;)”">​</a></h1><p><strong>Version:</strong> 0.1.1 <strong>Status:</strong> Approved <strong>Feature:</strong> Error Handling Suffix Operator</p><h2 id="_1-overview" tabindex="-1">1. Overview <a class="header-anchor" href="#_1-overview" aria-label="Permalink to “1. Overview”">​</a></h2><p>The <strong>Error Rescue Operator</strong> (<code>!&gt;</code>) is a binary suffix operator designed for inline error handling of <code>Result&lt;T, E&gt;</code> types. It allows developers to handle <code>Err</code> variants using a concise closure syntax or by invoking a handler function directly, without disrupting the visual flow of the &quot;happy path.&quot;</p><p>It serves as the semantic counterpart to the <code>??</code> (Null Coalescing) operator, but specifically for <strong>Errors</strong> rather than <strong>Absence</strong> (Option/Null).</p><h2 id="_2-syntax" tabindex="-1">2. Syntax <a class="header-anchor" href="#_2-syntax" aria-label="Permalink to “2. Syntax”">​</a></h2><p>The operator supports two forms on the Right Hand Side (RHS):</p><h3 id="form-a-inline-block-closure" tabindex="-1">Form A: Inline Block (Closure) <a class="header-anchor" href="#form-a-inline-block-closure" aria-label="Permalink to “Form A: Inline Block (Closure)”">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">expression </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">error_variable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { block }</span></span></code></pre></div><h3 id="form-b-direct-callable-function-closure" tabindex="-1">Form B: Direct Callable (Function/Closure) <a class="header-anchor" href="#form-b-direct-callable-function-closure" aria-label="Permalink to “Form B: Direct Callable (Function/Closure)”">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">expression </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> handler_function</span></span></code></pre></div><ul><li><strong>LHS (Left Hand Side):</strong> An expression evaluating to <code>Result&lt;T, E&gt;</code>.</li><li><strong>Operator:</strong> <code>!&gt;</code></li><li><strong>RHS (Right Hand Side):</strong> * An inline closure definition <code>|e| { ... }</code>. <ul><li>A callable expression (function name, closure variable) with signature <code>fn(E) -&gt; T</code>.</li></ul></li></ul><h3 id="grammar" tabindex="-1">Grammar <a class="header-anchor" href="#grammar" aria-label="Permalink to “Grammar”">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">error_handling_expr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> expression </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;!&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ( inline_closure </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> callable_expression )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inline_closure      </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;|&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> identifier </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;|&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> block</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">callable_expression </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> identifier </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> call_expression </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span></span></code></pre></div><h2 id="_3-semantics" tabindex="-1">3. Semantics <a class="header-anchor" href="#_3-semantics" aria-label="Permalink to “3. Semantics”">​</a></h2><p>Given the statement <code>let value = result_expr !&gt; handler;</code></p><ol><li><strong>Evaluation:</strong> The LHS <code>result_expr</code> is evaluated first.</li><li><strong>Success Path (<code>Ok</code>):</strong><ul><li>If the result is <code>Ok(v)</code>, the value <code>v</code> is unwrapped.</li><li>The RHS (handler) is <strong>skipped</strong> entirely.</li><li><code>value</code> becomes <code>v</code>.</li></ul></li><li><strong>Failure Path (<code>Err</code>):</strong><ul><li>If the result is <code>Err(e)</code>, the RHS is invoked with <code>e</code> as the argument.</li><li><strong>Inline Block:</strong> The block executes with <code>e</code> bound to the capture variable.</li><li><strong>Direct Callable:</strong> The function/closure is called as <code>handler(e)</code>.</li><li><strong>Recovery:</strong> The return value of the handler (must be type <code>T</code>) is assigned to <code>value</code>.</li><li><strong>Early Return:</strong> If the handler executes a <code>return</code> statement (or is a diverging function like <code>panic</code>), the flow exits the current scope.</li></ul></li></ol><h2 id="_4-type-rules" tabindex="-1">4. Type Rules <a class="header-anchor" href="#_4-type-rules" aria-label="Permalink to “4. Type Rules”">​</a></h2><p>For an expression <code>L !&gt; R</code>:</p><ul><li><strong>LHS Type:</strong> Must be <code>Result&lt;T, E&gt;</code>.</li><li><strong>RHS Type:</strong> Must be a callable <code>fn(E) -&gt; T</code> (or <code>fn(E) -&gt; noreturn</code>). <ul><li><strong>Argument:</strong> Must match the error type <code>E</code> of the LHS.</li><li><strong>Return:</strong> Must match the success type <code>T</code> of the LHS (for recovery) OR be <code>noreturn</code>.</li></ul></li></ul><h2 id="_5-precedence-and-associativity" tabindex="-1">5. Precedence and Associativity <a class="header-anchor" href="#_5-precedence-and-associativity" aria-label="Permalink to “5. Precedence and Associativity”">​</a></h2><ul><li><strong>Precedence:</strong> Lower than method calls (<code>.</code>) and function calls <code>()</code>, but higher than assignment (<code>=</code>).</li><li><strong>Associativity:</strong> Left-associative.</li></ul><h2 id="_6-examples" tabindex="-1">6. Examples <a class="header-anchor" href="#_6-examples" aria-label="Permalink to “6. Examples”">​</a></h2><h3 id="scenario-a-inline-recovery-default-value" tabindex="-1">Scenario A: Inline Recovery (Default Value) <a class="header-anchor" href="#scenario-a-inline-recovery-default-value" aria-label="Permalink to “Scenario A: Inline Recovery (Default Value)”">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// If parse fails, log the error and use DefaultConfig</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> config </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> read_file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(path)?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse_json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    log.warn(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Config invalid: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> + err.msg);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DefaultConfig </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Evaluates to T</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h3 id="scenario-b-direct-function-handler" tabindex="-1">Scenario B: Direct Function Handler <a class="header-anchor" href="#scenario-b-direct-function-handler" aria-label="Permalink to “Scenario B: Direct Function Handler”">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fn </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">handle_db_error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e: DbError): User {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DB Error: &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e.msg);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> User.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">guest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Returns a fallback User</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Pass function directly without wrapping in closure</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">find_user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> handle_db_error;</span></span></code></pre></div><h3 id="scenario-c-early-return-guard" tabindex="-1">Scenario C: Early Return (Guard) <a class="header-anchor" href="#scenario-c-early-return-guard" aria-label="Permalink to “Scenario C: Early Return (Guard)”">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// If database fails, log and exit the function with an error</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">find_user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">err</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    return </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AppError.databaseFail); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Exits parent function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h3 id="scenario-d-panic-abort-with-function" tabindex="-1">Scenario D: Panic/Abort with Function <a class="header-anchor" href="#scenario-d-panic-abort-with-function" aria-label="Permalink to “Scenario D: Panic/Abort with Function”">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Using a standard library panic function directly</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> texture </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> load_asset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hero.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> panic;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Assuming panic accepts the error string or implements Display</span></span></code></pre></div><h2 id="_7-rationale" tabindex="-1">7. Rationale <a class="header-anchor" href="#_7-rationale" aria-label="Permalink to “7. Rationale”">​</a></h2><ul><li><strong>Symbology:</strong> The <code>!</code> symbol connotes &quot;Alert/Error&quot;, and <code>&gt;</code> connotes &quot;Forward/Redirect&quot;. Together (<code>!&gt;</code>), they signify &quot;On Error, redirect flow to...&quot;.</li><li><strong>Conflict Analysis:</strong><ul><li>Does not conflict with Greater Than (<code>&gt;</code>) or Logical NOT (<code>!</code>).</li><li>Does not conflict with Inequality (<code>!=</code>).</li><li>Does not conflict with Math (<code>&lt;=</code>).</li></ul></li><li><strong>Separation of Concerns:</strong> Distinct from <code>??</code> (Null Coalescing): <ul><li><code>??</code> for <strong>Data Absence</strong> (<code>Option</code>).</li><li><code>!&gt;</code> for <strong>Operation Failure</strong> (<code>Result</code>).</li></ul></li><li></li></ul>`,33)])])}const g=s(n,[["render",l]]);export{k as __pageData,g as default};
